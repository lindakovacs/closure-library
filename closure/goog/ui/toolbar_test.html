<!DOCTYPE html>
<html>
<!--
Copyright 2014 The Closure Library Authors. All Rights Reserved.

Use of this source code is governed by the Apache License, Version 2.0.
See the COPYING file for details.
-->
<!--
-->
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Closure Unit Tests - goog.ui.Toolbar</title>
  <script src="../base.js"></script>
  <script>
    goog.require('goog.a11y.aria');
    goog.require('goog.dom');
    goog.require('goog.testing.jsunit');
    goog.require('goog.ui.Toolbar');
    goog.require('goog.ui.ToolbarMenuButton');
  </script>
  </head>
<body>
  <div id="toolbar-wrapper"></div>
  <script>
    var toolbar;
    var toolbarWrapper;

    function setUp() {
      toolbar = new goog.ui.Toolbar();
      toolbarWrapper = goog.dom.getElement('toolbar-wrapper');
    }

    function tearDown() {
      toolbar.dispose();
    }

    function testHandleFocus() {
      // Render and populate the toolbar.
      toolbar.render(toolbarWrapper);
      var toolbarElem = toolbar.getElement();
      var button1 = new goog.ui.ToolbarMenuButton('button 1');
      var button2 = new goog.ui.ToolbarMenuButton('button 2');
      button1.render(toolbarElem);
      button2.render(toolbarElem);
      toolbar.addChild(button1);
      toolbar.addChild(button2);

      // Verify that focusing the toolbar highlights the first item and sets it as the active
      // descendant.
      toolbar.handleFocus();
      assertEquals(0, toolbar.getHighlightedIndex());
      assertTrue(button1.isHighlighted());
      assertEquals(button1.getElement(), goog.a11y.aria.getActiveDescendant(toolbarElem));

      // Verify that removing focus unhighlights the first item and removes it as the active
      // descendant.
      toolbar.handleBlur();
      assertEquals(-1, toolbar.getHighlightedIndex());
      assertNull(goog.a11y.aria.getActiveDescendant(toolbarElem));
    }
  </script>
</body>
</html>
